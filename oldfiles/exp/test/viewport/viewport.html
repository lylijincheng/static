<!doctype html>

<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>viewport: safari on ios</title>
    <style>
        html, body, h2, div {
            margin: 0;
            padding: 0;
        }
    </style>

    <script>
        // Safari on iOS viewport

        // Executed at window onload.

        window.addEventListener('load', calcViewport, !1);
        window.addEventListener('orientationchange', calcViewport, !1);

        function calcViewport() {

            /* -------------------- viewport -------------------- */
            this.viewport = function() {

                var width, height, screenWidth, screenHeight, innerWidth, innerHeight, isSafariOnIOS, orientation, userAgent;

                screenWidth  = window.screen.width;
                screenHeight = window.screen.height;
                innerWidth   = window.innerWidth;
                innerHeight  = window.innerHeight; 

                userAgent    = navigator.userAgent;
                orientation  = window.orientation;

                isSafariOnIOS = /Version\/(\d)\.\d Mobile/i.exec(userAgent);    

                width = innerWidth;
                
                height 
                = isSafariOnIOS 
                ? Math.max(innerHeight, (navigator.standalone ? innerHeight : ((orientation == 0 || orientation == 180) ? screenHeight - 44 : screenWidth - 32) - 20))
                : innerHeight;

                return {
                    "width": width,
                    "height": height
                }
            }();
            /* -------------------- viewport -------------------- */
            

            var scrollTimeout = setTimeout(function() {
                window.scrollTo(0, 1);
            }, 0);

            // test
            document.body.style.minHeight = this.viewport.height + 'px';
            document.getElementById('container-width').innerText = "width: " + this.viewport.width;
            document.getElementById('container-height').innerText = "height: " + this.viewport.height;

        }

    </script>
</head>
<body>
    
    <h2>viewport:</h2><hr />
    <div id="container-width"></div>
    <div id="container-height"></div>
    
    <!-- 

    <h2>code: </h2><hr />
    <pre><code>
        // Safari on iOS viewport

        // Executed at window onload.

        window.addEventListener('load', function() {
           
           this.viewport = function() {

                var width, height, screenWidth, screenHeight, innerWidth, innerHeight, isSafariOnIOS, orientation, userAgent;

                screenWidth  = window.screen.width;
                screenHeight = window.screen.height;
                innerWidth   = window.innerWidth;
                innerHeight  = window.innerHeight; 

                userAgent    = navigator.userAgent;
                orientation  = window.orientation;

                isSafariOnIOS = /Version\/(\d)\.\d Mobile/i.exec(userAgent);    

                width = innerWidth;
                
                height 
                = isSafariOnIOS 
                ? Math.max(innerHeight, (navigator.standalone ? innerHeight : ((orientation == 0 || orientation == 90) ? screenHeight - 44 : screenWidth - 32) - 20)
                : innerHeight;

                return {
                    "width": width,
                    "height": height
                }
            }();

            document.getElementById('container-width').innerText = this.viewport.width;
            document.getElementById('container-height').innerText = this.viewport.height;

        }, false);      
    </code></pre>

    -->

    <!-- 

    iOS Platform: Version 5.1.1
    Safari on iOS 5.1   "Mozilla/5.0 (iPhone; CPU iPhone OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Version/5.1 Mobile/9B208 Safari/7534.48.3"
    Safari on iOS 6     "Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A403 Safari/8536.25"
    Chrome on iOS       "Mozilla/5.0 (iPhone; CPU iPhone OS 5_1_1 like Mac OS X; zh-cn) AppleWebKit/534.46.0 (KHTML, like Gecko) CriOS/21.0.1180.80 Mobile/9B208 Safari/7534.48.3 (C037B678-A630-40AC-9D5D-9282CC5CAD71)"
    UC Browser          "Mozilla/5.0 (iPhone; CPU iPhone OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B208"
    Dolphin Browser     "Mozilla/5.0 (iPhone; CPU iPhone OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B208"
    QQ Browser          "MQQBrowser/36 Mozilla/5.0 (iPhone 4; CPU iPhone OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B208 Safari/7534.48.3"
    Maxmon Browser      "Mozilla/5.0 (iPhone; CPU iPhone OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Version/5.1 Mobile/9B206 Safari/7534.48.3"
    360 Browser         "Mozilla/5.0 (iPhone; CPU iPhone OS 5_0 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Version/5.1 Mobile/9A334 Safari/7534.48.3"

    Android Platform: Version 2.3

    Android Platform: Version 4.0.3
    
    -->
</body>
</html>